// ============================================================
// 1. KOORDINAT POLYGON MASTER (VARIABEL GLOBAL)
// ============================================================

// Polygon Desa Galih (Kuning - Background Utama)
const POLY_DESA_GALIH = [
    [-7.808762, 112.896381], [-7.809949, 112.896231], [-7.810725, 112.896394], [-7.812848, 112.895910],
    [-7.813272, 112.897058], [-7.813911, 112.897229], [-7.815008, 112.897272], [-7.815752, 112.897711],
    [-7.816275, 112.897639], [-7.818646, 112.899821], [-7.818396, 112.900724], [-7.819161, 112.900734],
    [-7.819707, 112.900403], [-7.820462, 112.901146], [-7.820489, 112.901897], [-7.820361, 112.902680],
    [-7.821101, 112.902778], [-7.821795, 112.902688], [-7.822534, 112.902490], [-7.823555, 112.903113],
    [-7.823933, 112.903573], [-7.824078, 112.904661], [-7.824179, 112.905970], [-7.823780, 112.906853],
    [-7.823796, 112.907674], [-7.823195, 112.909083], [-7.823130, 112.910525], [-7.824248, 112.911659],
    [-7.825552, 112.912372], [-7.825921, 112.912869], [-7.826685, 112.913142], [-7.827294, 112.913384],
    [-7.827611, 112.914082], [-7.827434, 112.914600], [-7.828445, 112.914744], [-7.829121, 112.915242],
    [-7.829724, 112.919683], [-7.829774, 112.920048], [-7.828535, 112.919647], [-7.828432, 112.919558],
    [-7.827860, 112.919175], [-7.827393, 112.918597], [-7.826591, 112.918336], [-7.825464, 112.917424],
    [-7.824777, 112.917501], [-7.824390, 112.917512], [-7.823483, 112.917647], [-7.822929, 112.917587],
    [-7.822351, 112.917505], [-7.821987, 112.917575], [-7.821526, 112.917771], [-7.821150, 112.917809],
    [-7.820278, 112.917746], [-7.819710, 112.917641], [-7.819274, 112.917400], [-7.818961, 112.917216],
    [-7.818393, 112.917344], [-7.817989, 112.917451], [-7.817452, 112.917573], [-7.816700, 112.917523],
    [-7.815418, 112.917572], [-7.814986, 112.917583], [-7.814695, 112.917488], [-7.814394, 112.917585],
    [-7.813776, 112.917912], [-7.813340, 112.918544], [-7.812689, 112.919122], [-7.812244, 112.919433],
    [-7.811595, 112.919180], [-7.810653, 112.918808], [-7.810059, 112.918749], [-7.809357, 112.918530],
    [-7.808099, 112.918568], [-7.807142, 112.918960], [-7.806667, 112.919230], [-7.806300, 112.919427],
    [-7.805567, 112.919482], [-7.804080, 112.919080], [-7.803074, 112.919166], [-7.801602, 112.919579],
    [-7.801069, 112.919463], [-7.799337, 112.918953], [-7.798747, 112.919251], [-7.797709, 112.919479],
    [-7.796681, 112.919582], [-7.796265, 112.919369], [-7.795734, 112.918876], [-7.795409, 112.918546],
    [-7.794721, 112.917835], [-7.794251, 112.917396], [-7.793438, 112.917008], [-7.792633, 112.916853],
    [-7.792286, 112.916940], [-7.792327, 112.915885], [-7.792513, 112.914834], [-7.793244, 112.912589],
    [-7.792862, 112.908891], [-7.791499, 112.907447], [-7.789350, 112.907732], [-7.787715, 112.907215],
    [-7.787661, 112.905639], [-7.789726, 112.896976], [-7.791369, 112.896043], [-7.793827, 112.895279],
    [-7.796051, 112.895214], [-7.798318, 112.895220], [-7.800123, 112.895726], [-7.801298, 112.895249],
    [-7.802471, 112.894794], [-7.802755, 112.895035], [-7.803399, 112.895195], [-7.804655, 112.895078],
    [-7.805747, 112.895103], [-7.807522, 112.895894], [-7.808761, 112.895559], [-7.808762, 112.896381]
];

// Polygon Desa Petung (Hijau - Background untuk 2022)
const POLY_PETUNG = [
    [-7.796914, 112.919663], [-7.797714, 112.919479], [-7.799335, 112.918953], [-7.800971, 112.919417],
    [-7.802550, 112.919333], [-7.804106, 112.919072], [-7.805290, 112.919377], [-7.806556, 112.919309], 
    [-7.808091, 112.918568], [-7.809347, 112.918523], [-7.810559, 112.918819], [-7.812242, 112.919435],
    [-7.813691, 112.917952], [-7.814388, 112.917587], [-7.815253, 112.917557], [-7.816216, 112.917475],
    [-7.817074, 112.917624], [-7.817590, 112.917528], [-7.818538, 112.917258], [-7.819329, 112.917483],
    [-7.820277, 112.917746], [-7.821464, 112.917787], [-7.822231, 112.917496], [-7.823247, 112.917706],
    [-7.824206, 112.917451], [-7.825082, 112.917495], [-7.826166, 112.917971], [-7.827393, 112.918595],
    [-7.828411, 112.919538], [-7.829622, 112.920887], [-7.829514, 112.922454], [-7.829389, 112.923354],
    [-7.828586, 112.927328], [-7.828083, 112.928694], [-7.827647, 112.930261], [-7.827291, 112.931113],
    [-7.827291, 112.931858], [-7.827259, 112.933403], [-7.827424, 112.934596], [-7.827437, 112.935081],
    [-7.827456, 112.935495], [-7.827387, 112.935945], [-7.827355, 112.936221], [-7.827313, 112.936484],
    [-7.827240, 112.936905], [-7.827046, 112.937365], [-7.826497, 112.937245], [-7.826223, 112.937160],
    [-7.825721, 112.936556], [-7.823816, 112.936135], [-7.821125, 112.935331], [-7.820142, 112.935495],
    [-7.819173, 112.935895], [-7.817943, 112.935891], [-7.815550, 112.934849], [-7.813814, 112.934379],
    [-7.810570, 112.933965], [-7.807909, 112.934547], [-7.805737, 112.934772], [-7.803789, 112.935324],
    [-7.801021, 112.935521], [-7.799307, 112.935640], [-7.797865, 112.935338], [-7.796267, 112.934272],
    [-7.794864, 112.933069], [-7.793586, 112.931982], [-7.793202, 112.930642], [-7.791249, 112.930842],
    [-7.789550, 112.931263], [-7.786136, 112.933870], [-7.784061, 112.934598], [-7.781894, 112.934225],
    [-7.780761, 112.933728], [-7.780153, 112.923638], [-7.777995, 112.921008], [-7.777560, 112.920252],
    [-7.777495, 112.919307], [-7.777063, 112.918702], [-7.776446, 112.916364], [-7.776211, 112.913816],
    [-7.778111, 112.912734], [-7.779409, 112.913824], [-7.779663, 112.914042], [-7.779977, 112.915403],
    [-7.781197, 112.916585], [-7.781888, 112.916864], [-7.783083, 112.917021], [-7.785225, 112.916404],
    [-7.788040, 112.917301], [-7.790695, 112.916773], [-7.791831, 112.916885], [-7.792639, 112.916854],
    [-7.793770, 112.917083], [-7.795551, 112.918696], [-7.796494, 112.919515]
];

// Polygon Hutan Lindung (Cluster Atas - Untuk 2021)
const POLY_HUTAN_LINDUNG = [
    [-7.822741, 112.905788], [-7.823905, 112.906751], [-7.825361, 112.912290], 
    [-7.827303, 112.913405], [-7.829434, 112.915337], [-7.829796, 112.920093], 
    [-7.827299, 112.918696], [-7.825592, 112.917413], [-7.822625, 112.917634],
    [-7.820846, 112.917861], [-7.818717, 112.917288], [-7.816762, 112.917521], 
    [-7.814898, 112.917478], [-7.812872, 112.919064], [-7.809485, 112.918544],
    [-7.805723, 112.919556], [-7.801831, 112.919549], [-7.799517, 112.918969], 
    [-7.793862, 112.917117], [-7.792420, 112.914979], [-7.793254, 112.909957],
    [-7.791199, 112.907287], [-7.788098, 112.907606], [-7.799964, 112.895831],
    [-7.806259, 112.895221], [-7.810119, 112.896051], [-7.815065, 112.897235],
    [-7.818627, 112.899828], [-7.820345, 112.900821], [-7.821373, 112.902746],
    [-7.822741, 112.905788]
];

// Polygon Delineasi 2023
const POLY_PECATON = [
    [-7.82193, 112.90484], [-7.82227, 112.90491], [-7.82284, 112.90498], 
    [-7.82327, 112.90566], [-7.82244, 112.90586], [-7.82188, 112.90555], 
    [-7.82182, 112.90539], [-7.82188, 112.90484], [-7.82193, 112.90484]
];
const POLY_TEGAL_GALIH = [
    [-7.81560, 112.91466], [-7.81568, 112.91490], [-7.81589, 112.91528], 
    [-7.81569, 112.91543], [-7.81527, 112.91520], [-7.81524, 112.91477], [-7.81560, 112.91466]
];
const POLY_TEGAL_KARYONO = [
    [-7.81442, 112.91306], [-7.81437, 112.91288], [-7.81422, 112.91269], 
    [-7.81446, 112.91236], [-7.81462, 112.91277], [-7.81462, 112.91297], [-7.81442, 112.91306]
];

// Plot 2022
const POLY_PLOT_PETUNG = [
    [-7.814693, 112.927523], [-7.814690, 112.927990], [-7.814259, 112.927990], [-7.814263, 112.927519]
];
const POLY_PLOT_GALIH = [
    [-7.808837, 112.911005], [-7.809100, 112.911005], [-7.809101, 112.911281], [-7.808840, 112.911275]
];

// ============================================================
// 2. FEATURE COLLECTION: 17 DELINEASI 2024 (WARNA-WARNI)
// ============================================================
const FEATURES_2024 = [
    { type: "Feature", properties: { name: "Hutan Lestari Supinto", color: "#006064" }, geometry: { type: "Polygon", coordinates: [[ [112.90507, -7.81659], [112.90538, -7.81639], [112.90486, -7.81646] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Karji", color: "#e65100" }, geometry: { type: "Polygon", coordinates: [[ [112.90254, -7.81366], [112.90337, -7.81335], [112.90263, -7.81347] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Andari 01", color: "#ff5252" }, geometry: { type: "Polygon", coordinates: [[ [112.90525, -7.81510], [112.90448, -7.81546], [112.90477, -7.81620] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Juman Tugu 02", color: "#ffea00" }, geometry: { type: "Polygon", coordinates: [[ [112.91223, -7.81609], [112.91196, -7.81631], [112.91234, -7.81639] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Andari 02", color: "#01579b" }, geometry: { type: "Polygon", coordinates: [[ [112.90023, -7.80581], [112.89940, -7.80565], [112.89985, -7.80596] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Kariono Gondrong", color: "#3949ab" }, geometry: { type: "Polygon", coordinates: [[ [112.90895, -7.81266], [112.90905, -7.81291], [112.90920, -7.81255] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Juman Gentong 01", color: "#ffd600" }, geometry: { type: "Polygon", coordinates: [[ [112.91306, -7.81441], [112.91259, -7.81423], [112.91297, -7.81462] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Seneto", color: "#880e4f" }, geometry: { type: "Polygon", coordinates: [[ [112.91058, -7.81678], [112.91041, -7.81652], [112.91015, -7.81730] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Ngadi", color: "#7cb342" }, geometry: { type: "Polygon", coordinates: [[ [112.91318, -7.80997], [112.91294, -7.80985], [112.91267, -7.81009] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Sudikso", color: "#c2185b" }, geometry: { type: "Polygon", coordinates: [[ [112.90308, -7.81365], [112.90369, -7.81399], [112.90345, -7.81373] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Sugita", color: "#097138" }, geometry: { type: "Polygon", coordinates: [[ [112.90433, -7.81374], [112.90437, -7.81320], [112.90382, -7.81335] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Sukarjo", color: "#fbc02d" }, geometry: { type: "Polygon", coordinates: [[ [112.90118, -7.80720], [112.90123, -7.80667], [112.90069, -7.80683] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Wanto", color: "#f9a825" }, geometry: { type: "Polygon", coordinates: [[ [112.91187, -7.80048], [112.91207, -7.79988], [112.91190, -7.80014] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Suwito", color: "#f57c00" }, geometry: { type: "Polygon", coordinates: [[ [112.90600, -7.82163], [112.90536, -7.82099], [112.90474, -7.82239], [112.90668, -7.82326], [112.90832, -7.82267], [112.90662, -7.81980] ]] } },
    { type: "Feature", properties: { name: "Hutan Lestari Misti", color: "#558b2f" }, geometry: { type: "Polygon", coordinates: [[ [112.91344, -7.81492], [112.91367, -7.81455], [112.91325, -7.81447] ]] } }
];

// ============================================================
// 3. DATABASE UTAMA
// ============================================================

const db_planting = {
    // Digunakan oleh Leaflet untuk menampilkan 17 blok warna-warni di 2024
    polygons: {
        "type": "FeatureCollection",
        "features": FEATURES_2024
    },

    years: {
        // --- TAHUN 2025 ---
        "tanam_2025": {
            id: "tanam_2025",
            year: 2025,
            location: "Desa Galih & Kawasan Penyangga",
            desc: "Fokus pada pengayaan tanaman buah produktif.",
            stats: { trees: 0, rorak: 0, sumur: 0, biopori: 0 },
            species: { "Alpukat": 0, "Durian": 0 },
            points: [ [-7.705, 112.920, "Pohon"] ],
            areaPolygon: [POLY_DESA_GALIH],
            photos: ["https://via.placeholder.com/400x300?text=Tanam+2025"]
        },
        
        // --- TAHUN 2024 (17 BLOK + RORAK) ---
        "tanam_2024": {
            id: "tanam_2024",
            year: 2024,
            location: "Hutan Lestari Desa Galih (17 Area)",
            desc: "Konservasi intensif di 17 plot Hutan Lestari.",
            stats: { trees: 2000, rorak: 1500, sumur: 0, biopori: 0 },
            species: { "Kopi Robusta": 1000, "Durian": 300, "Alpukat": 200, "Lainnya": 1000 },
            points: [
                // Rorak
                [-7.81636, 112.90502, "Rorak Supinto"], [-7.81351, 112.90287, "Rorak Karji"],
                [-7.80559, 112.89978, "Rorak Andari"], [-7.81595, 112.90508, "Rorak Andari 1"],
                [-7.81622, 112.91214, "Rorak Juman"], [-7.81278, 112.90909, "Rorak Karono"],
                [-7.82289, 112.90786, "Rorak Pecaton"], [-7.80683, 112.90100, "Rorak Sukarjo"],
                // Pohon Sample
                [-7.82267, 112.90535, "Kopi Robusta"], [-7.81547, 112.91491, "Kopi Robusta"]
            ],
            // Gunakan POLY_DESA_GALIH sebagai background, blok kecil via FEATURES_2024 di HTML
            areaPolygon: [POLY_DESA_GALIH], 
            photos: ["https://via.placeholder.com/400x300?text=Hutan+Lestari+2024"]
        },

        // --- TAHUN 2023 ---
        "tanam_2023": {
            id: "tanam_2023",
            year: 2023,
            location: "Program Konservasi AQUA Keboncandi Tahun 2023",
            desc: "Intensifikasi penanaman di area Pecaton dan Tegal.",
            stats: { trees: 5000, rorak: 500, sumur: 0, biopori: 110 },
            species: { "Kopi Robusta": 4000, "Naungan": 1000 },
            points: [
                [-7.82260, 112.90530, "Kopi"], [-7.82270, 112.90540, "Kopi"], [-7.82280, 112.90550, "Kopi"],
                [-7.81560, 112.91480, "Kopi"], [-7.81570, 112.91490, "Kopi"], [-7.81440, 112.91300, "Kopi"]
            ],
            // Memasukkan POLY_DESA_GALIH agar peta desa muncul + Delineasi
            areaPolygon: [POLY_DESA_GALIH, POLY_PECATON, POLY_TEGAL_GALIH, POLY_TEGAL_KARYONO],
            photos: ["https://via.placeholder.com/400x300?text=Tanam+2023"]
        },

        // --- TAHUN 2022 ---
        "tanam_2022": {
            id: "tanam_2022",
            year: 2022,
            location: "Program Konservasi Tahun 2022",
            desc: "Program agroforestri di Petung dan Desa Galih.",
            stats: { trees: 10000, rorak: 750, sumur: 20, biopori: 300 },
            species: { "Kopi Robusta": 9500, "Naungan": 500 },
            points: [
                [-7.81431, 112.92754, "Kopi"], [-7.81436, 112.92774, "Kopi"], [-7.81451, 112.92765, "Kopi"],
                [-7.80904, 112.91107, "Kopi"], [-7.80895, 112.91114, "Kopi"], [-7.80913, 112.91114, "Kopi"]
            ],
            // Peta Desa Galih (Kiri) + Peta Petung (Kanan) + Plot Detail
            areaPolygon: [POLY_DESA_GALIH, POLY_PETUNG, POLY_PLOT_PETUNG, POLY_PLOT_GALIH],
            photos: ["https://via.placeholder.com/400x300?text=Kopi+2022"]
        },
        
        // --- TAHUN 2021 ---
        "tanam_2021": {
            id: "tanam_2021",
            year: 2021,
            location: "Program Konservasi AQUA Keboncandi",
            desc: "Rehabilitasi hutan lindung dan agroforestri.",
            stats: { trees: 5000, rorak: 250, sumur: 10, biopori: 300 },
            species: { "Alpukat": 1500, "Nangka": 1500, "Sukun": 1000 },
            points: [
                [-7.82274, 112.90578, "Alpukat"], [-7.82390, 112.90675, "Nangka"], [-7.82536, 112.91229, "Sukun"],
                [-7.80692, 112.90921, "Alpukat"], [-7.80613, 112.90209, "Nangka"], [-7.81735, 112.91578, "Sukun"]
            ],
            // Desa Galih + Hutan Lindung (Cluster Atas)
            areaPolygon: [POLY_DESA_GALIH, POLY_HUTAN_LINDUNG], 
            photos: ["https://via.placeholder.com/400x300?text=Bibit+2021"]
        }
    }
};
